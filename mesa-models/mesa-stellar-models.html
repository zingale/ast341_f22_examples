
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>MESA Models &#8212; AST 341 Fall 2022</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="hot-CNO and breakout" href="../hotcno/hot-CNO-breakout-example.html" />
    <link rel="prev" title="C++ Example" href="../lane-emden/le_cxx.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">AST 341 Fall 2022</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    AST 341
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Stellar Structure
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../simple-stellar-structure/f22-stellar-model-hw1.html">
   Simple Stellar Structure
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Thermodynamics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../thermo/thermodynamics.html">
   Thermodynamics and the Maxwell-Boltzmann distribution
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Integrating ODEs
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../orbits_example/ODEs-partI.html">
   Basic Methods for ODEs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../orbits_example/ODEs-partII.html">
   Higher-order Accurate ODE Integration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../orbits_example/cxx.html">
   C++ Example
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  PP-CNO
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../reactions/pp-cno.html">
   Comparison of PP and CNO burning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lane-Emden
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lane-emden/lane-emden.html">
   Lane-Emden polytrope equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lane-emden/le_cxx.html">
   C++ Example
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MESA Models
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   MESA Models
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Explosions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../hotcno/hot-CNO-breakout-example.html">
   hot-CNO and breakout
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../equipotentials/equipotentials.html">
   Equipotentials
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/zingale/ast341_f22_examples/main?urlpath=tree/content/mesa-models/mesa-stellar-models.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/zingale/ast341_f22_examples/blob/main/content/mesa-models/mesa-stellar-models.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/zingale/ast341_f22_examples"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/zingale/ast341_f22_examples/issues/new?title=Issue%20on%20page%20%2Fmesa-models/mesa-stellar-models.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/mesa-models/mesa-stellar-models.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-hr-diagram">
   1. a. HR diagram
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-central-evolution">
   1. b. central evolution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#c-main-sequence-lifetime">
   1. c. Main sequence lifetime
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-eddington-standard-model">
   2. a. Eddington Standard Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-he-flash">
   (b) He flash
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>MESA Models</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-hr-diagram">
   1. a. HR diagram
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-central-evolution">
   1. b. central evolution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#c-main-sequence-lifetime">
   1. c. Main sequence lifetime
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-eddington-standard-model">
   2. a. Eddington Standard Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#b-he-flash">
   (b) He flash
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="mesa-models">
<h1>MESA Models<a class="headerlink" href="#mesa-models" title="Permalink to this headline">#</a></h1>
<p>Our goal is to plot various quantities from MESA stellar evolution models of 1, 8, and 15 <span class="math notranslate nohighlight">\(M_\odot\)</span> stars, and compare
to the simple stellar models we developed so far in the course.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>We’ll make some classes to store the data from the model files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Profile</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pfile</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">pfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu_e</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">8</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">9</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_a</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_T</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="mi">12</span><span class="p">]</span>
        
        <span class="c1"># the age is specified on the first line</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">pf</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">pf</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">History</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hfile</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">hfile</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rho_c</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_c</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_eff</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">h</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Model</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">profiles</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">history</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass</span> <span class="o">=</span> <span class="n">mass</span>
        <span class="k">if</span> <span class="n">history</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">history</span> <span class="o">=</span> <span class="n">History</span><span class="p">(</span><span class="n">history</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">profiles</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">profiles</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Profile</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now read in all the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">profiles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M1.0_profile_H_simple.out&quot;</span><span class="p">,</span> <span class="s2">&quot;M1.0_profile_He_simple.out&quot;</span><span class="p">],</span>
                    <span class="n">history</span><span class="o">=</span><span class="s2">&quot;M1.0_history_simple.out&quot;</span><span class="p">))</span>

<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">profiles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M8.0_profile_H_simple.out&quot;</span><span class="p">,</span> <span class="s2">&quot;M8.0_profile_He_simple.out&quot;</span><span class="p">],</span>
                    <span class="n">history</span><span class="o">=</span><span class="s2">&quot;M8.0_history_simple.out&quot;</span><span class="p">))</span>

<span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Model</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">profiles</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;M15.0_profile_H_simple.out&quot;</span><span class="p">,</span> <span class="s2">&quot;M15.0_profile_He_simple.out&quot;</span><span class="p">],</span>
                    <span class="n">history</span><span class="o">=</span><span class="s2">&quot;M15.0_history_simple.out&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Fundamental constants</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># CGS constants</span>
<span class="n">k_B</span> <span class="o">=</span> <span class="mf">1.38e-16</span>
<span class="n">m_u</span> <span class="o">=</span> <span class="mf">1.66e-24</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">9.11e-28</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">3.e10</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">6.63e-27</span>
<span class="n">a</span> <span class="o">=</span> <span class="mf">5.67e-15</span>
</pre></div>
</div>
</div>
</div>
<section id="a-hr-diagram">
<h2>1. a. HR diagram<a class="headerlink" href="#a-hr-diagram" title="Permalink to this headline">#</a></h2>
<p>Now we’ll make an HR diagram and label the points where <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(He\)</span> burning commences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">T_eff</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">L</span><span class="p">,</span>
              <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">star</span><span class="o">.</span><span class="n">mass</span><span class="si">}</span><span class="s2"> $M_\odot$&quot;</span><span class="p">)</span>
    <span class="n">ih</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">age</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">T_eff</span><span class="p">[</span><span class="n">ih</span><span class="p">],</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">L</span><span class="p">[</span><span class="n">ih</span><span class="p">],</span> <span class="s2">&quot;H&quot;</span><span class="p">)</span>
    <span class="n">ihe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">age</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">T_eff</span><span class="p">[</span><span class="n">ihe</span><span class="p">],</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">L</span><span class="p">[</span><span class="n">ihe</span><span class="p">],</span> <span class="s2">&quot;He&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/mesa-stellar-models_12_0.png" src="../_images/mesa-stellar-models_12_0.png" />
</div>
</div>
<p>You can see the main sequence clearly on this plot simply by connecting the points marked “H”.  We also see that only the 1 solar mass star “finished’ stellar evolution, winding up as a cooling white dwarf at the end – the path it is following is essentially a line of constant radius, since the white dwarf does not contract as it cools (it is degenerate).</p>
</section>
<section id="b-central-evolution">
<h2>1. b. central evolution<a class="headerlink" href="#b-central-evolution" title="Permalink to this headline">#</a></h2>
<p>First well find the boundary where degeneracy (NR) and ideal gas balance:</p>
<div class="math notranslate nohighlight">
\[\frac{\rho k_B T}{\mu m_u} = \frac{h^2}{20m_e} \left (\frac{3}{\pi}\right )^{2/3} \frac{1}{(\mu_e m_u)^{5/3}} \rho^{5/3}\]</div>
<p>We’ll write a function that returns <span class="math notranslate nohighlight">\(\rho\)</span> given <span class="math notranslate nohighlight">\(T\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rho_ideal_deg</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">mu_e</span><span class="o">=</span><span class="mf">1.3</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">k_B</span><span class="o">*</span><span class="n">T</span><span class="o">/</span><span class="p">(</span><span class="n">mu</span><span class="o">*</span><span class="n">m_u</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">h</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">m_e</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">mu_e</span><span class="o">*</span><span class="n">m_u</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">5.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)))</span><span class="o">**</span><span class="p">(</span><span class="mf">3.</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next the boundary where radition and idea gas balance:</p>
<div class="math notranslate nohighlight">
\[\frac{\rho k_B T}{\mu m_u} = \frac{1}{3}a T^4\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rho_ideal_rad</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.6</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">T</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">m_u</span><span class="o">/</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">k_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can plot the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">T_c</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">rho_c</span><span class="p">,</span>
              <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">star</span><span class="o">.</span><span class="n">mass</span><span class="si">}</span><span class="s2"> $M_\odot$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">T_c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">rho_c</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="n">ih</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">age</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">T_c</span><span class="p">[</span><span class="n">ih</span><span class="p">],</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">rho_c</span><span class="p">[</span><span class="n">ih</span><span class="p">],</span> <span class="s2">&quot;H&quot;</span><span class="p">)</span>
    <span class="n">ihe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">age</span><span class="p">))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">T_c</span><span class="p">[</span><span class="n">ihe</span><span class="p">],</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">rho_c</span><span class="p">[</span><span class="n">ihe</span><span class="p">],</span> <span class="s2">&quot;He&quot;</span><span class="p">)</span>
<span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">rho_ideal_deg</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">rho_ideal_rad</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$T_c$ [K]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho_c$ [g/cc]&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/mesa-stellar-models_20_0.png" src="../_images/mesa-stellar-models_20_0.png" />
</div>
</div>
<p>Comparing to the plots in chapter 7, we see the behaviour we expect.  The higher mass stars are closer to the line where radiation dominates.  The 1 solar mass star makes a transition from following <span class="math notranslate nohighlight">\(T \approx \rho^{1/3}\)</span> to <span class="math notranslate nohighlight">\(\rho = \mbox{constant}\)</span> when degeneracy kicks in.  The other stars more or less follow the <span class="math notranslate nohighlight">\(T \approx \rho^{1/3}\)</span> trend expected from polytropes + ideal gas.</p>
<p>The points labeled H and He are in the middle of those core burning phases.</p>
<p>We can actually add the ignition curves that we did in homework 5 to these plots!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">q_H</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">q_min</span><span class="o">=</span><span class="mf">1.e3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;return the density for the given temperature for H burning&quot;&quot;&quot;</span>
    
    <span class="c1"># we have either pp or CNO here</span>
    <span class="c1"># we write q_pp = rho A</span>
    <span class="c1"># we write q_CNO = rho B</span>
    <span class="n">T_9</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">1.e9</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">2.4e4</span><span class="o">*</span><span class="n">X</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">T_9</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">3.38</span><span class="o">/</span><span class="n">T_9</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">))</span>
    <span class="n">B</span> <span class="o">=</span> <span class="mf">4.4e25</span><span class="o">*</span><span class="n">X</span><span class="o">*</span><span class="n">Z</span><span class="o">*</span><span class="n">T_9</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">15.228</span><span class="o">/</span><span class="n">T_9</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">))</span>
    
    <span class="n">C</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
    <span class="c1"># take which ever is larger</span>
    <span class="c1">#C = np.where(A &gt; B, A, B)</span>
    
    <span class="k">return</span> <span class="n">q_min</span><span class="o">/</span><span class="n">C</span>

<span class="k">def</span> <span class="nf">q_He</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">q_min</span><span class="o">=</span><span class="mf">1.e3</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;return the density for a given temperature for He burning&quot;&quot;&quot;</span>
    
    <span class="n">T_8</span> <span class="o">=</span> <span class="n">T</span><span class="o">/</span><span class="mf">1.e8</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mf">5.09e11</span><span class="o">*</span><span class="n">Y</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">T_8</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">44.027</span><span class="o">/</span><span class="n">T_8</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">q_min</span><span class="o">/</span><span class="n">A</span><span class="p">)</span>

<span class="n">T_H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mf">6.8</span><span class="p">,</span><span class="mf">7.5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">rho_H</span> <span class="o">=</span> <span class="n">q_H</span><span class="p">(</span><span class="n">T_H</span><span class="p">,</span> <span class="n">q_min</span><span class="o">=</span><span class="mf">1.e2</span><span class="p">)</span>

<span class="n">T_He</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mf">7.9</span><span class="p">,</span><span class="mf">8.3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">rho_He</span> <span class="o">=</span> <span class="n">q_He</span><span class="p">(</span><span class="n">T_He</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_H</span><span class="p">,</span> <span class="n">rho_H</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_He</span><span class="p">,</span> <span class="n">rho_He</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.5&quot;</span><span class="p">)</span>

<span class="n">fig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/mesa-stellar-models_24_0.png" src="../_images/mesa-stellar-models_24_0.png" />
</div>
</div>
</section>
<section id="c-main-sequence-lifetime">
<h2>1. c. Main sequence lifetime<a class="headerlink" href="#c-main-sequence-lifetime" title="Permalink to this headline">#</a></h2>
<p>We can estimate the main sequence lifetime just by looking for when the core H is all consumed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="n">star</span><span class="o">.</span><span class="n">history</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">star</span><span class="o">.</span><span class="n">mass</span><span class="si">}</span><span class="s2"> $M_\odot$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">1.e4</span><span class="p">,</span> <span class="mf">2.e10</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/mesa-stellar-models_27_0.png" src="../_images/mesa-stellar-models_27_0.png" />
</div>
</div>
<p>From this plot, we see that the main sequence lifetime of the 15 <span class="math notranslate nohighlight">\(M_\odot\)</span> star is <span class="math notranslate nohighlight">\(\sim 6\times 10^6\)</span> yr, for the 8 <span class="math notranslate nohighlight">\(M_\odot\)</span> star <span class="math notranslate nohighlight">\(\sim 2\times 10^7\)</span> yr, and for the 1 <span class="math notranslate nohighlight">\(M_\odot\)</span> star <span class="math notranslate nohighlight">\(\sim 9\times 10^9\)</span> yr.</p>
</section>
<section id="a-eddington-standard-model">
<h2>2. a. Eddington Standard Model<a class="headerlink" href="#a-eddington-standard-model" title="Permalink to this headline">#</a></h2>
<p>The Eddington standard model works for a fully radiative star with a constant composition.</p>
<p>In class, we found that the temperature and density in the Eddington standard model were related by</p>
<div class="math notranslate nohighlight">
\[T(r) = 4.62\times 10^6 \beta\mu \left ( \frac{M}{M_\odot} \right)^{2/3} \rho^{1/3}(r)\]</div>
<p>We will assume that <span class="math notranslate nohighlight">\(\mu\)</span> is constant and take <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> from the center of the star.</p>
<p>Here’s a function to compute <span class="math notranslate nohighlight">\(\beta\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_beta</span><span class="p">(</span><span class="n">profile</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;compute the raito of gas to total pressure&quot;&quot;&quot;</span>
    <span class="n">P_g</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">k_B</span> <span class="o">*</span> <span class="n">profile</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">m_u</span><span class="p">)</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">P_g</span> <span class="o">/</span> <span class="n">profile</span><span class="o">.</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">beta</span>
</pre></div>
</div>
</div>
</div>
<p>and here’s a function to return the <span class="math notranslate nohighlight">\(T(\rho)\)</span> curve predicted by the Eddington standard model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eddington_T</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">4.62e6</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">M</span><span class="o">**</span><span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span> <span class="o">*</span> <span class="n">rho</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For convection, we need <span class="math notranslate nohighlight">\(\nabla &gt; \nabla_\mathrm{ad}\)</span>.  We have those quantities in the model files.</p>
<p>Here’s our plotting function.  We will plot the data from the MESA model and the line corresponding to the Eddington standard model.  We will also mark those zones in the MESA model where <span class="math notranslate nohighlight">\(\nabla &gt; \nabla_\mathrm{ad}\)</span> with red squares, to indicate that it is convective.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_plot</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">rho</span><span class="p">)</span>
    
    <span class="c1"># find where it is convective</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">profile</span><span class="o">.</span><span class="n">grad_T</span> <span class="o">&gt;=</span> <span class="n">profile</span><span class="o">.</span><span class="n">grad_a</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">profile</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span>
               <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">eddington_T</span><span class="p">(</span><span class="n">profile</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">profile</span><span class="o">.</span><span class="n">mu</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">M</span><span class="p">),</span> <span class="n">profile</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span>
              <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Eddington standard model&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;T [K]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;rho [g/cc]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;M = </span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2"> $M_\odot$; age = </span><span class="si">{</span><span class="n">profile</span><span class="o">.</span><span class="n">age</span><span class="si">}</span><span class="s2"> years&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">mass</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">get_beta</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">make_plot</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/mesa-stellar-models_38_0.png" src="../_images/mesa-stellar-models_38_0.png" />
<img alt="../_images/mesa-stellar-models_38_1.png" src="../_images/mesa-stellar-models_38_1.png" />
<img alt="../_images/mesa-stellar-models_38_2.png" src="../_images/mesa-stellar-models_38_2.png" />
</div>
</div>
<p>Looking at these plots, keep in mind that the center of the star is in the upper right.  We see that:</p>
<ul class="simple">
<li><p>For the 1 <span class="math notranslate nohighlight">\(M_\odot\)</span> star, since the core is radiative, we match well up util we first become convective.</p></li>
<li><p>For the 2 more massive stars, there are small convective cores and then radiative envelopes, and the Eddington standard
model does well for most of the radiative envelope.</p></li>
</ul>
</section>
<section id="b-he-flash">
<h2>(b) He flash<a class="headerlink" href="#b-he-flash" title="Permalink to this headline">#</a></h2>
<p>A helium flash occurs when we ignite core He burning under degenerate conditions.  We’ll use the same line derived up in Q1 to define degeneracy.</p>
<p>Now we’ll plot all of the He-burning models together with the line indicating degeneracy.  We will assume that the composition is pure He, which has <span class="math notranslate nohighlight">\(\mu = 4/3\)</span>, <span class="math notranslate nohighlight">\(\mu_e = 2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="k">for</span> <span class="n">star</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">mass</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">star</span><span class="o">.</span><span class="n">profiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">rho</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">M</span><span class="si">}</span><span class="s2"> $M_\odot$&quot;</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">rho_ideal_deg</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">mu_e</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f3484a99d10&gt;
</pre></div>
</div>
<img alt="../_images/mesa-stellar-models_43_1.png" src="../_images/mesa-stellar-models_43_1.png" />
</div>
</div>
<p>We see that the 1 <span class="math notranslate nohighlight">\(M_\odot\)</span> model comes closest to the degeneracy line, so this is the only model where we might expect a He flash to occur (we note that these models are from the point when core He burning was already midway through, not at ignition).</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./mesa-models"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../lane-emden/le_cxx.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">C++ Example</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../hotcno/hot-CNO-breakout-example.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">hot-CNO and breakout</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By <a href="https://zingale.github.io">Michael Zingale</a><br/>
  
    <div class="extra_footer">
      <p>
&copy; 2021; CC-BY-NC-SA 4.0
<p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>